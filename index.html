<html>
	<head>
		<script src="general.js" type="text/javascript"></script>
	</head>
	<body>
		<div>
			<div id="index"></div>
			<img id="img" src="">
			<input id="text" type="text"/>
			<input id="button" type="button" value="送出">
			<div id="caption"></div>
		</div>
		<script type="text/javascript">
var req = new XMLHttpRequest()
var server = 'http://140.112.211.69:8787/'
req.open('GET',server)
req.setRequestHeader('Content-Type','application/X-www-form-urlencoded')
req.send()
req.onreadystatechange = function () {
	if(req.readyState === XMLHttpRequest.DONE){
		console.log(server + ' responded with status ' + req.status)
		if(req.status>=200 && req.status<400){
			var index = Number(req.response)
			$('#img').attr('src','http://140.112.211.69/ml/'+index+'.png')
			$('#index').apnd(index+' / 2999')

			$('#button').$e('click',(e)=>{
				if(!$('#text').value.match(/^[A-z][A-z]{1,2}[A-z]$/)) {
					$('#caption').apnd('請輸入 3 ~ 4 位小寫英文字母！')
					return
				}
				var req = new XMLHttpRequest()
				var server = 'http://140.112.211.69:8787/'
				req.open('POST',server+index)
				req.setRequestHeader('Content-Type','application/X-www-form-urlencoded')
				req.send('text='+$('#text').value.toLowerCase())
				req.onreadystatechange = function () {
					if(req.readyState === XMLHttpRequest.DONE){
						console.log(server + ' responded with status ' + req.status)
						$('#caption').apnd('輸入成功！')
						$('#button').remove()
					}
				}
			})
		}
	}
}
		</script>
	</body>
</html>